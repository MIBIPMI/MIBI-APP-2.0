const Stripe=require('stripe');module.exports=async(req,res)=>{const sig=req.headers['stripe-signature'];const secret=process.env.STRIPE_WEBHOOK_SECRET;if(!secret)return res.status(500).send('Webhook secret not configured');try{const stripe=Stripe(process.env.STRIPE_SECRET_KEY);const raw=req.rawBody||JSON.stringify(req.body);const event=stripe.webhooks.constructEvent(raw,sig,secret);console.log('Webhook event',event.type);res.json({received:true});}catch(e){console.error('Webhook verification failed',e);res.status(400).send(`Webhook Error: ${e.message}`);}}